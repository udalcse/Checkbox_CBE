(function () {
    // Load plugin specific language pack
    tinymce.PluginManager.requireLangPack('upload');

    //    tinymce.PluginManager.add('upload', tinymce.plugins.UploadPlugin);
    tinymce.PluginManager.add('upload', function (editor, url) {
        editor.addCommand('mceUpload', function () {
            editor.focus();
            editor.windowManager.open({
                title: 'Upload',
                file: url + '/dialog.htm',
                width: 700 + parseInt(editor.getLang('upload.delta_width', 0)),
                height: 300 + parseInt(editor.getLang('upload.delta_height', 0)),
                inline: 1
            }, {});
        });
        
        // Add a button that opens a window
        editor.addButton('upload', {
            title: 'Upload file',
            icon: true,
            image: url + '/img/upload.png',
            cmd: 'mceUpload'
        });
    });
}
)();